<ng-container *ngIf="(vm$ | async) as vm">
    <table cdk-table [dataSource]="dataSource$" aria-describedby="table-body" class="list-view-table table-striped table">

        <ng-container cdkColumnDef="checkbox">
            <th cdk-header-cell scope="col" *cdkHeaderCellDef class="primary-table-header"></th>
            <td cdk-cell *cdkCellDef="let record">
                <label class="checkbox-container">
                    <input type="checkbox"
                           [checked]="(record['id'] && vm.selected[record['id']]) || allSelected(vm.selectionStatus) "
                           (change)="toggleSelection(record['id'])"
                           [disabled]="allSelected(vm.selectionStatus)"
                           aria-hidden="true">
                    <span class="checkmark"></span>
                </label>
            </td>
        </ng-container>

        <ng-container *ngFor="let column of vm.listMetadata.fields" [cdkColumnDef]="column.fieldName">
            <th cdk-header-cell
                *cdkHeaderCellDef
                scope="col"
                class="primary-table-header">
                {{getFieldLabel(column.label)}}
                <scrm-sort-button *ngIf="column.sortable" [state]="getFieldSort(column)"></scrm-sort-button>
            </th>
            <td cdk-cell *cdkCellDef="let record">
                <scrm-field [mode]="'list'"
                            [type]="column.type"
                            [field]="getField(column, record)"
                            [record]="record">
                </scrm-field>
            </td>
        </ng-container>

        <tr cdk-header-row *cdkHeaderRowDef="vm.displayedColumns"></tr>
        <tr cdk-row *cdkRowDef="let row; columns: vm.displayedColumns;"></tr>
    </table>
</ng-container>
